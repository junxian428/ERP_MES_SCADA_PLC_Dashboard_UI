{"ast":null,"code":"'use strict';\n\nrequire(\"core-js/modules/es.array.push.js\");\nvar util = require('util');\nvar async = require('async');\nvar EventEmitter = require('events');\nfunction Offset(client) {\n  EventEmitter.call(this);\n  var self = this;\n  this.client = client;\n  this.ready = this.client.ready;\n  this.client.on('ready', function () {\n    self.ready = true;\n    self.emit('ready');\n  });\n  this.client.once('connect', function () {\n    self.emit('connect');\n  });\n  this.client.on('error', function (err) {\n    self.emit('error', err);\n  });\n}\nutil.inherits(Offset, EventEmitter);\nOffset.prototype.fetch = function (payloads, cb) {\n  if (!this.ready) {\n    this.once('ready', () => this.fetch(payloads, cb));\n    return;\n  }\n  this.client.sendOffsetRequest(this.buildPayloads(payloads), cb);\n};\nOffset.prototype.buildPayloads = function (payloads) {\n  return payloads.map(function (p) {\n    p.partition = p.partition || 0;\n    p.time = p.time || Date.now();\n    p.maxNum = p.maxNum || 1;\n    p.metadata = 'm'; // metadata can be arbitrary\n    return p;\n  });\n};\nOffset.prototype.buildOffsetFetchV1Payloads = function (payloads) {\n  return payloads.reduce(function (out, p) {\n    out[p.topic] = out[p.topic] || [];\n    out[p.topic].push(p.partition || 0);\n    return out;\n  }, {});\n};\nOffset.prototype.commit = function (groupId, payloads, cb) {\n  if (!this.ready) {\n    this.once('ready', () => this.commit(groupId, payloads, cb));\n    return;\n  }\n  this.client.sendOffsetCommitRequest(groupId, this.buildPayloads(payloads), cb);\n};\nOffset.prototype.fetchCommits = Offset.prototype.fetchCommitsV1 = function (groupId, payloads, cb) {\n  if (!this.ready) {\n    this.once('ready', () => this.fetchCommitsV1(groupId, payloads, cb));\n    return;\n  }\n  this.client.setCoordinatorIdAndSendOffsetFetchV1Request(groupId, this.buildOffsetFetchV1Payloads(payloads), cb);\n};\nOffset.prototype.fetchLatestOffsets = function (topics, cb) {\n  fetchOffsets(this, topics, cb, -1);\n};\nOffset.prototype.fetchEarliestOffsets = function (topics, cb) {\n  fetchOffsets(this, topics, cb, -2);\n};\n\n// private helper\nfunction fetchOffsets(offset, topics, cb, when) {\n  if (!offset.ready) {\n    if (when === -1) {\n      offset.once('ready', () => offset.fetchLatestOffsets(topics, cb));\n    } else if (when === -2) {\n      offset.once('ready', () => offset.fetchEarliestOffsets(topics, cb));\n    }\n    return;\n  }\n  async.waterfall([callback => {\n    offset.client.loadMetadataForTopics(topics, callback);\n  }, (topicsMetaData, callback) => {\n    var payloads = [];\n    var metaDatas = topicsMetaData[1].metadata;\n    Object.keys(metaDatas).forEach(function (topicName) {\n      var topic = metaDatas[topicName];\n      Object.keys(topic).forEach(function (partition) {\n        payloads.push({\n          topic: topicName,\n          partition: partition,\n          time: when\n        });\n      });\n    });\n    if (payloads.length === 0) {\n      return callback(new Error('Topic(s) does not exist'));\n    }\n    offset.fetch(payloads, callback);\n  }, function (results, callback) {\n    Object.keys(results).forEach(function (topicName) {\n      var topic = results[topicName];\n      Object.keys(topic).forEach(function (partitionName) {\n        topic[partitionName] = topic[partitionName][0];\n      });\n    });\n    callback(null, results);\n  }], cb);\n}\nmodule.exports = Offset;","map":{"version":3,"names":["require","util","async","EventEmitter","Offset","client","call","self","ready","on","emit","once","err","inherits","prototype","fetch","payloads","cb","sendOffsetRequest","buildPayloads","map","p","partition","time","Date","now","maxNum","metadata","buildOffsetFetchV1Payloads","reduce","out","topic","push","commit","groupId","sendOffsetCommitRequest","fetchCommits","fetchCommitsV1","setCoordinatorIdAndSendOffsetFetchV1Request","fetchLatestOffsets","topics","fetchOffsets","fetchEarliestOffsets","offset","when","waterfall","callback","loadMetadataForTopics","topicsMetaData","metaDatas","Object","keys","forEach","topicName","length","Error","results","partitionName","module","exports"],"sources":["D:/Project/VUEJSSPRING_CRUD_JWT/vue-crud-api-jwt-vuex/node_modules/kafka-node/lib/offset.js"],"sourcesContent":["'use strict';\n\nvar util = require('util');\nvar async = require('async');\nvar EventEmitter = require('events');\n\nfunction Offset (client) {\n  EventEmitter.call(this);\n  var self = this;\n  this.client = client;\n  this.ready = this.client.ready;\n  this.client.on('ready', function () {\n    self.ready = true;\n    self.emit('ready');\n  });\n  this.client.once('connect', function () {\n    self.emit('connect');\n  });\n  this.client.on('error', function (err) {\n    self.emit('error', err);\n  });\n}\nutil.inherits(Offset, EventEmitter);\n\nOffset.prototype.fetch = function (payloads, cb) {\n  if (!this.ready) {\n    this.once('ready', () => this.fetch(payloads, cb));\n    return;\n  }\n  this.client.sendOffsetRequest(this.buildPayloads(payloads), cb);\n};\n\nOffset.prototype.buildPayloads = function (payloads) {\n  return payloads.map(function (p) {\n    p.partition = p.partition || 0;\n    p.time = p.time || Date.now();\n    p.maxNum = p.maxNum || 1;\n    p.metadata = 'm'; // metadata can be arbitrary\n    return p;\n  });\n};\n\nOffset.prototype.buildOffsetFetchV1Payloads = function (payloads) {\n  return payloads.reduce(function (out, p) {\n    out[p.topic] = out[p.topic] || [];\n    out[p.topic].push(p.partition || 0);\n    return out;\n  }, {});\n};\n\nOffset.prototype.commit = function (groupId, payloads, cb) {\n  if (!this.ready) {\n    this.once('ready', () => this.commit(groupId, payloads, cb));\n    return;\n  }\n  this.client.sendOffsetCommitRequest(groupId, this.buildPayloads(payloads), cb);\n};\n\nOffset.prototype.fetchCommits = Offset.prototype.fetchCommitsV1 = function (groupId, payloads, cb) {\n  if (!this.ready) {\n    this.once('ready', () => this.fetchCommitsV1(groupId, payloads, cb));\n    return;\n  }\n  this.client.setCoordinatorIdAndSendOffsetFetchV1Request(groupId, this.buildOffsetFetchV1Payloads(payloads), cb);\n};\n\nOffset.prototype.fetchLatestOffsets = function (topics, cb) {\n  fetchOffsets(this, topics, cb, -1);\n};\n\nOffset.prototype.fetchEarliestOffsets = function (topics, cb) {\n  fetchOffsets(this, topics, cb, -2);\n};\n\n// private helper\nfunction fetchOffsets (offset, topics, cb, when) {\n  if (!offset.ready) {\n    if (when === -1) {\n      offset.once('ready', () => offset.fetchLatestOffsets(topics, cb));\n    } else if (when === -2) {\n      offset.once('ready', () => offset.fetchEarliestOffsets(topics, cb));\n    }\n    return;\n  }\n  async.waterfall(\n    [\n      callback => {\n        offset.client.loadMetadataForTopics(topics, callback);\n      },\n      (topicsMetaData, callback) => {\n        var payloads = [];\n        var metaDatas = topicsMetaData[1].metadata;\n        Object.keys(metaDatas).forEach(function (topicName) {\n          var topic = metaDatas[topicName];\n          Object.keys(topic).forEach(function (partition) {\n            payloads.push({\n              topic: topicName,\n              partition: partition,\n              time: when\n            });\n          });\n        });\n\n        if (payloads.length === 0) {\n          return callback(new Error('Topic(s) does not exist'));\n        }\n\n        offset.fetch(payloads, callback);\n      },\n      function (results, callback) {\n        Object.keys(results).forEach(function (topicName) {\n          var topic = results[topicName];\n\n          Object.keys(topic).forEach(function (partitionName) {\n            topic[partitionName] = topic[partitionName][0];\n          });\n        });\n        callback(null, results);\n      }\n    ],\n    cb\n  );\n}\n\nmodule.exports = Offset;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}